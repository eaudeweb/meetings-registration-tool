{% extends "_layout.html" %}

{% block content %}

  {% set page_title='Edit a Staff member' if staff else 'Add a new Staff member' %}

  <div class="container">

    <div class="page-header">
      <h2>{{ page_title }}</h2>
    </div>

    <form class="well form-horizontal" role="form" method="post">
      {{ form.csrf_token }}

      <div class="form-group row">
        {{ form.title.label(class_='control-label col-sm-2') }}
        <div class="controls col-sm-10">
          {{ form.title }}
        </div>
      </div>

      <div class="form-group row">
        {{ form.full_name.label(class_='control-label col-sm-2') }}
        <div class="controls col-sm-10">
          {{ form.full_name }}
        </div>
      </div>

      {% if form.user %}
      <div class="form-group row">
        {{ form.user.label(class_='control-label col-sm-2') }}
        <div class="controls col-sm-10">
          <ul class="list-unstyled">
            <li>
              {{ form.user.email.label }}
              {{ form.user.email }}
            </li>
            <li>
              {{ form.user.password.label }}
              {{ form.user.password }}
            </li>
          </ul>
        </div>
      </div>
      {% endif %}

      <input type=hidden value="{{ next or '' }}" name=next>

      <div class="row">
        <button class="btn btn-primary" type="submit">Add</button>
        {% if staff %}
          <div id="delete-button">
            <a class="btn btn-primary btn-danger">Delete</a>
          </div>
        {% endif %}
        <a class="btn btn-default" href="{{ url_for('.list') }}">Cancel</a>
      </div>
    </form>

  </div>

{% endblock %}

{% block scripts %}
  <script>
    $(function() {
      $("#delete-button").on("click", ".btn-primary", function (e) {
        e.preventDefault();
        var url = $(this).attr("href");
        if (confirm('Are you sure you want to delete this member?')) {
          $.ajax({
            type: "DELETE",
            url: url
        }).done(function (data) {
          var data = $.parseJSON(data);
          document.location = data.url;
        });
        }
        });

    });
  </script>

{% endblock %}
