{% extends "meetings/_base.html" %}
{% from "_bits.html" import breadcrumb, form_group %}


{% set title = "Overview" %}


{% block title %} {{ title }} {% endblock %}

{% block scripts %}

  {% assets "upload_js" %}
     <script src="{{ ASSET_URL }}"></script>
  {% endassets %}

{% endblock %}

{% block breadcrumb %} {{ breadcrumb([('', title)]) }} {% endblock %}


{% block content %}

  {{ super() }}

  <h3 class="page-title">{{ title }}</h3>


  <table class="table bg-warning">

    <tbody>
      {% if g.meeting.online_registration %}
        <tr>
          <td><h4>Participant registration form</h4></td>
          <td>
            {% set url = url_for('meetings.registration',
                                 _external=True) %}
            <h4><a href="{{ url }}">{{ url }}</a></h4>
          </td>
        </tr>
      {% endif %}

      {% if g.meeting.media_participant_enabled %}
        <tr>
          <td><h4>Media Participant registration form</h4></td>
          <td>
            {% set url = url_for('meetings.media_registration',
                                 _external=True) %}
            <h4><a href="{{ url }}">{{ url }}</a></h4>
          </td>
        </tr>
      {% endif %}
    </tbody>

  </table>

  <div class="row">
    <div class="col-sm-5">
      <table class="table table-bordered">
        <thead>
          <tr class="row">
            <th class="col-sm-6">Categories</th>
            <th class="col-sm-4">Data type</th>
            <th>Total</th>
          </tr>
        </thead>

        {% for category, persons in participants|groupby('category.title.english') %}
          <tr class="row">
            <th rowspan="2" class="col-sm-6">{{ category }}</th>
            <td class="col-sm-4">Countries</td>
            <td>{{ persons|countries|length }}</td>
          </tr>

          <tr class="row">
            <td class="col-sm-4">Delegates</td>
            <td>{{ persons|length }}</td>
          </tr>
        {% endfor %}

      </table>
    </div>

    <div class="col-sm-4 col-sm-offset-1">
      <table class="table table-bordered">
        <thead>
          <tr class="row">
            <th class="col-sm-8">Media categories</th>
            <th class="col-sm-4">Total</th>
          </tr>
        </thead>

        {% for category, persons in media_participants|groupby('category.title.english') %}

        <tr class="row">
          <td class="col-sm-8">{{ category }}</td>
          <td class="col-sm-4">{{ persons|length }}</td>
        </tr>

        {% endfor %}

      </table>
    </div>
  </div>

  <div class="row">
    <div class="col-sm-6">
      {% with title='PRODUCT_LOGO', form=left_logo_form %}
        {% include "meetings/overview/_image_widget.html" %}
      {% endwith %}
    </div>

    <div class="col-sm-6">
      {% with title='PRODUCT_SIDE_LOGO', form=right_logo_form %}
        {% include "meetings/overview/_image_widget.html" %}
      {% endwith %}
    </div>
  </div>

{% endblock %}
