
{% macro form_group(field, label_size="2", input_size="8",
                    class_="", options={}) %}

  {% set label_cls = "col-sm-" + label_size  + " control-label" %}

  <div class="form-group {% if field.errors %}has-error{% endif %}">
    <label class="{{ label_cls }}" for="{{ field.id }}">
      {{ field.label.text }}
      {% if field.flags.required %}
        <span class="text-danger">*</span>
      {% endif %}
    </label>
    {% if field.type not in ('FileField',) %}
      {% set cls = "form-control " + class_ %}
    {% else %}
      {% set cls = class_ %}
    {% endif %}
    <div class="col-sm-{{ input_size }}">
      {{ field(class_=cls, placeholder=field.label.text, **options) }}
      {% if field.errors %}
        <div class="text-danger"><small>{{ field.errors[0] }}</small></div>
      {% endif %}
    </div>
  </div> {# form-group #}


{% endmacro %}


{% macro breadcrumb(crumbs) %}

  <ol class="breadcrumb">
    {% for crumb in crumbs %}
      <li class="{% if loop.last %}active{% endif %}">
        {% if not loop.last %}
          <a href="{{ crumb[0] }}">{{ crumb[1] }}</a>
        {% else %}
         {{ crumb[1] }}
        {% endif %}
      </li>
    {% endfor %}
  </ol>

{% endmacro %}


{% macro row_link(link) %}

  <div class="row-link">
    <a href="{{ link[0] }}" class="label label-danger">
      {{ link[1] }}</a>
  </div>

{% endmacro %}

{% macro activity_url(activity) %}
  {% if activity.participant_id %}
    {% set url = url_for('.participant_detail', participant_id=activity.participant_id) %}
    <a href="{{ url }}"><span class="glyphicon glyphicon-arrow-right"></span></a>
  {% else %}
    <span class="delete">deleted</span>
  {% endif %}
{% endmacro %}


{% macro flashed_messages() -%}

  {% for categ, msg in get_flashed_messages(with_categories=True) %}
    <div class="alert alert-{{ categ }} center-block" role="alert">
      <button type="button" class="close" data-dismiss="alert">
        <span aria-hidden="true">&times;</span></button>
      {{ msg|safe }}</div>
  {% endfor %}

{%- endmacro %}


{% macro list_inputs(inputs) %}

  <ul class="list-unstyled row">
    {% for input in inputs %}
      <li class="col-sm-4">
        {{ input.label }}
        {% if input.flags.required %}
          <span class="text-danger">*</span>
        {% endif %}
        {{ input(class_="form-control",
                 placeholder=input.label.text) }}
        {% if input.flags.required %}
          <div class="text-danger">
            <small>{{ input.errors[0] }}</small>
          </div>
        {% endif %}
      </li>
    {% endfor %}
  </ul>

{% endmacro %}


{% macro form_group_with_list_inputs(field, label_size="2",
                                     input_size="8") %}

  {% set label_cls = "col-sm-" + label_size  + " control-label" %}

  <div class="form-group {% if field.errors %}has-error{% endif %}">
    <label class="{{ label_cls }}" for="{{ field.id }}">
      {{ field.label.text }}
      {% if field.flags.required %}
        <span class="text-danger">*</span>
      {% endif %}
    </label>

    <div class="col-sm-{{ input_size }}">
      <div class="panel panel-default">
        <div class="panel-body">
          {{ list_inputs([field.english, field.french,
                          field.spanish]) }}
        </div>
      </div>
      {% if field.errors %}
        <div class="text-danger">
          <small>{{ field.errors[0] }}</small></div>
      {% endif %}
    </div>
  </div> {# form-group #}

{% endmacro %}
